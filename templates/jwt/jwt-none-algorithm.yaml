id: jwt-none-algorithm
info:
  name: JWT None Algorithm Confusion
  severity: critical
  description: Tests for JWT algorithm confusion vulnerability (none algorithm)
  tags:
    - jwt
    - authentication

variables:
  email: "{{USER_EMAIL}}"
  password: "{{USER_PASSWORD}}"

requests:
  - name: Authenticate to get JWT
    method: POST
    path: /rest/user/login
    headers:
      Content-Type: application/json
    body: '{"email": "{{email}}", "password": "{{password}}"}'
    extractors:
      - type: json
        name: original_token
        selector: "$.authentication.token"

  - name: Test admin endpoint with original token
    method: GET
    path: /rest/admin/application-configuration
    headers:
      Authorization: "Bearer {{original_token}}"
    matchers:
      - type: status
        values: [200]
      - type: word
        words: ["configuration", "config"]
        condition: or
    on_match:
      vulnerability: JWT_ALGORITHM_CONFUSION
      message: Admin endpoint accessible - test JWT algorithm confusion manually
      remediation: Reject none algorithm and always verify signatures
