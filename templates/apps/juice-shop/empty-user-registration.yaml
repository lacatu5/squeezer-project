id: juice-shop-empty-user-registration
info:
  name: Empty User Registration Bypass
  author: dast-mvp
  owasp_category: A07:2025
  severity: medium
  description: Tests if application allows registration with empty/null values
  tags:
    - authentication
    - input-validation
    - authentication-bypass

requests:
  - path: /api/Users
    method: POST
    headers:
      Content-Type: application/json
    body: '{"email":"","password":"test123"}'
    matchers:
      - type: word
        words:
          - email must be unique
    on_match:
      vulnerability: EMPTY_USER_REGISTRATION
      message: Application accepts empty email - validation bypass

  - path: /api/Users
    method: POST
    headers:
      Content-Type: application/json
    body: '{"email":"test-empty-pwd@test.com","password":""}'
    matchers:
      - type: word
        words:
          - '"status":"success"'
    on_match:
      vulnerability: EMPTY_USER_REGISTRATION
      message: Application accepts empty password - weak authentication

  - path: /api/Users
    method: POST
    headers:
      Content-Type: application/json
    body: '{"email":null,"password":"test123"}'
    matchers:
      - type: word
        words:
          - email must be unique
    on_match:
      vulnerability: EMPTY_USER_REGISTRATION
      message: Application accepts null email - validation bypass
