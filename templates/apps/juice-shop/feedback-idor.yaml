id: juice-shop-feedback-idor
info:
  name: Feedback IDOR
  description: Access control violation - users can view feedback from other users
  owasp_category: A01:2025
  severity: medium
  tags:
    - idor
    - access-control
    - data-exfiltration

requests:
  - name: Access feedback ID 1
    method: GET
    path: /api/Feedbacks/1
    headers:
      Authorization: "{{bearer_token}}"
    matchers:
      - type: status
        values: [200]
      - type: json
        selector: "$.data"
        condition: exists
    on_match:
      vulnerability: INSECURE_DIRECT_OBJECT_REFERENCE
      message: Feedback from other users accessible via sequential ID enumeration
      remediation: Verify feedback ownership before allowing access - check UserId matches authenticated user

  - name: Access feedback ID 2
    method: GET
    path: /api/Feedbacks/2
    headers:
      Authorization: "{{bearer_token}}"
    matchers:
      - type: status
        values: [200]
      - type: json
        selector: "$.data"
        condition: exists
    on_match:
      vulnerability: INSECURE_DIRECT_OBJECT_REFERENCE
      message: Sequential feedback IDs can be enumerated - privacy violation
      remediation: Implement authorization check ensuring users can only access their own feedback

  - name: Access feedback list
    method: GET
    path: /api/Feedbacks/
    headers:
      Authorization: "{{bearer_token}}"
    matchers:
      - type: status
        values: [200]
      - type: json
        selector: "$.data"
        condition: exists
    on_match:
      vulnerability: INSECURE_DIRECT_OBJECT_REFERENCE
      message: All feedback accessible - may reveal other users' data
      remediation: Filter feedback by authenticated user's ID; never expose all records
