id: feedback-idor
info:
  name: Feedback IDOR Vulnerability
  description: Detects IDOR on feedback endpoints by accessing other users feedback
  tags:
    - idor
    - access-control

requests:
  - name: Try to access feedback from user 1
    method: GET
    path: /api/Feedbacks/1
    matchers:
      - type: status
        values: [200]
      - type: json
        selector: "$.data"
        condition: exists
    on_match:
      vulnerability: INSECURE_DIRECT_OBJECT_REFERENCE
      message: Can access feedback from other users by sequential ID
      remediation: Verify ownership before allowing access to user-generated content
