id: negative-quantity
info:
  name: Negative Quantity Business Logic Flaw
  description: Detects if server accepts negative quantity values in basket items
  tags:
    - business-logic
    - input-validation

requests:
  - name: Add item with negative quantity
    method: POST
    path: /api/BasketItems
    headers:
      Content-Type: application/json
    body: '{"ProductId": 1, "quantity": -100, "basketId": 999}'
    matchers:
      - type: status
        values: [200, 201]
      - type: json
        selector: "$.data.quantity"
        condition: negative
    on_match:
      vulnerability: NEGATIVE_QUANTITY
      message: Server accepted negative quantity in basket item
      remediation: Validate that quantity is a positive integer on the server side
