id: user-idor
info:
  name: User Profile IDOR Vulnerability
  description: Detects IDOR on user profile endpoints by accessing other user IDs
  tags:
    - idor
    - access-control

requests:
  - name: Try to access admin profile
    method: GET
    path: /api/Users/1
    matchers:
      - type: status
        values: [200]
      - type: json
        selector: "$.data.role"
        words: ["admin"]
    on_match:
      vulnerability: INSECURE_DIRECT_OBJECT_REFERENCE
      message: Can access admin user profile (ID=1) with current user token
      remediation: Enforce strict authorization checks on user data access

  - name: Try to access another user profile
    method: GET
    path: /api/Users/2
    matchers:
      - type: status
        values: [200]
      - type: json
        selector: "$.data"
        condition: exists
    on_match:
      vulnerability: INSECURE_DIRECT_OBJECT_REFERENCE
      message: Can access other user profiles by ID
      remediation: Enforce strict authorization checks on user data access
