id: juice-shop-file-upload-bypass
info:
  name: File Upload Validation Bypass
  author: dast-mvp
  owasp_category: A01:2025
  severity: high
  description: Tests for file upload validation bypass vulnerabilities
  tags:
    - file-upload
    - input-validation
    - misconfiguration

requests:
  - path: /api/Complaints
    method: POST
    headers:
      Content-Type: application/json
    body: '{"message":"test complaint","file":"../../../etc/passwd"}'
    matchers_condition: and
    matchers:
      - type: status
        status:
          - 200
          - 201
      - type: word
        words:
          - '"status":"success"'
    on_match:
      vulnerability: PATH_TRAVERSAL
      message: Complaints endpoint accepts path traversal in file parameter - may access arbitrary files
      remediation: Validate file paths; use basename() to extract filename only
