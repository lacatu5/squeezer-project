id: price-manipulation
info:
  name: Price Manipulation Business Logic Flaw
  description: Detects if client-provided price is accepted without validation
  tags:
    - business-logic
    - price-manipulation

requests:
  - name: Add item with manipulated negative price
    method: POST
    path: /api/BasketItems
    headers:
      Content-Type: application/json
    body: '{"ProductId": 1, "quantity": 1, "price": -999.99, "basketId": 999}'
    matchers:
      - type: status
        values: [200, 201]
      - type: json
        selector: "$.data"
        condition: exists
    on_match:
      vulnerability: PRICE_MANIPULATION
      message: Server accepted request with client-provided negative price
      remediation: Never accept price from client; always use server-side product catalog
