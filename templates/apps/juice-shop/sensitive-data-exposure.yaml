id: juice-shop-data-export-sqli
info:
  name: Data Export Sensitive Data Exposure
  author: dast-mvp
  owasp_category: A01:2025
  severity: high
  description: Tests for sensitive data exposure via data export functionality
  tags:
    - data-exposure
    - privacy
    - data-exfiltration

requests:
  - path: /rest/user/data-export
    method: POST
    headers:
      Authorization: "{{bearer_token}}"
      Content-Type: application/json
    body: '{"format":"xml"}'
    matchers_condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - 'email'
          - 'orders'
          - 'username'
        condition: and
    on_match:
      vulnerability: SENSITIVE_DATA_EXPOSURE
      message: Data export endpoint exposes all user PII including orders, email, reviews, and memories without additional verification
      remediation: Require re-authentication before data export and implement rate limiting

  - path: /rest/products/search
    method: GET
    query:
      q: "'||'"
    matchers_condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - 'Apple'
          - 'Orange'
        condition: and
    on_match:
      vulnerability: NOSQL_INJECTION
      message: NoSQL injection in product search - || operator returns all products
      remediation: Use proper parameterized queries and validate input
