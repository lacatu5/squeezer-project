id: juice-shop-basket-access
info:
  name: Unauthorized Basket Access (IDOR)
  author: dast-mvp
  owasp_category: A01:2025
  severity: high
  description: Tests for IDOR vulnerability allowing access to other users' baskets
  tags:
    - idor
    - access-control
    - data-exfiltration

requests:
  - path: /rest/basket/1
    method: GET
    matchers_condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - '"status":"success"'
          - Products
        condition: and
    on_match:
      vulnerability: INSECURE_DIRECT_OBJECT_REFERENCE
      message: Basket ID 1 accessible without authentication - IDOR vulnerability
      remediation: Require authentication; verify basket ownership before allowing access

  - path: /rest/basket/2
    method: GET
    matchers_condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - '"status":"success"'
          - Products
        condition: and
    on_match:
      vulnerability: INSECURE_DIRECT_OBJECT_REFERENCE
      message: Basket ID 2 accessible without authentication - sequential ID enumeration works
      remediation: Implement authorization check; use non-sequential basket IDs

  - path: /rest/basket/3
    method: GET
    matchers_condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - '"status":"success"'
          - Products
        condition: and
    on_match:
      vulnerability: INSECURE_DIRECT_OBJECT_REFERENCE
      message: Basket ID 3 accessible without authentication - confirms IDOR pattern
      remediation: Enforce ownership validation; users should only access their own baskets

  - path: /api/BasketItems
    method: GET
    matchers:
      - type: status
        status:
          - 200
    on_match:
      vulnerability: UNAUTHORIZED_ACCESS
      message: Basket items endpoint accessible without authentication
      remediation: Require valid authentication token to access basket data
