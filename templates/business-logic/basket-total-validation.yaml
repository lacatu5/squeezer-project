id: basket-total-validation
info:
  name: Basket Total Validation Flaw
  severity: high
  description: Detects if basket total is properly validated against item prices
  tags:
    - business-logic
    - validation

requests:
  - name: Check basket endpoint
    method: GET
    path: /api/Basket/{{basket_id}}
    matchers:
      - type: status
        values: [200]
    on_match:
      vulnerability: BASKET_TOTAL_VALIDATION
      message: Basket total validation requires manual verification
      remediation: Always recalculate basket total on server-side from product catalog prices
