id: generic-sqli-get-file
info:
  name: SQL Injection (GET) - External Payloads
  severity: critical
  description: Generic SQL injection testing with payloads from external file
  tags:
    - sqli
    - injection
    - generic
    - payloads-file

generic:
  endpoint: "{{sqli}}"
  method: GET
  parameter: "id"

  # Load payloads from external file (150+ payloads)
  payloads_file: "payloads/sqli-generic.txt"

  matchers:
    # SQL error messages
    - type: regex
      regex:
        - "SQL syntax.*?near"
        - "mysql_fetch.*?error"
        - "Warning.*?mysql_"
        - "ORA-\\d{5}"
        - "PostgreSQL.*?ERROR"
        - "SQLSTATE\\["
        - "SQLite3::SQLException"

    # Database function output (UNION-based)
    - type: regex
      regex:
        - "@@version\\s*[0-9]"
        - "version\\(\\)\\s*[0-9]"
        - "database\\(\\)"
        - "user\\(\\)"

    # Time-based detection
    - type: time
      threshold_ms: 3000

    # Exclude HTML pages (false positives)
    - type: word
      words:
        - "<!DOCTYPE html"
        - "<html>"
      negative: true
