id: generic-xss-reflected
info:
  name: Reflected XSS (GET)
  description: Detects reflected XSS in GET parameters across discovered endpoints
  owasp_category: A03:2025
  severity: medium
  tags:
    - xss
    - injection
    - generic

generic:
  endpoint: "{{all_discovered}}"
  method: GET
  parameter: "input"

  payloads:
    - "<script>alert(1)</script>"
    - "<img src=x onerror=alert(1)>"
    - "<svg/onload=alert(1)>"
    - "\"'><script>alert(1)</script>"
    - "javascript:alert(1)"
    - "<iframe src=javascript:alert(1)>"

  matchers:
    - type: regex
      condition: or
      regex:
        - "<script[^>]*>alert\\("
        - "<img[^>]*onerror"
        - "<svg[^>]*onload"
        - "javascript:alert\\("
        - "<iframe[^>]*src.*javascript"
        - "<script[^>]*>"
        - "onerror\\s*="
        - "onload\\s*="
    - type: word
      condition: or
      words:
        - "<script>"
        - "<img src"
        - "<svg"
        - "onerror"
        - "onload"
      case_sensitive: false

  matchers_condition: or
