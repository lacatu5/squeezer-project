id: generic-sqli-get
info:
  name: SQL Injection (GET)
  description: Detects SQL injection in GET parameters across discovered endpoints
  owasp_category: A03:2025
  severity: high
  tags:
    - sqli
    - injection
    - generic

generic:
  endpoint: "{{all_discovered}}"
  method: GET
  parameter: "input"

  payloads:
    - "'"
    - "')"
    - "')))"
    - "' OR '1'='1"
    - "' OR 1=1--"
    - "' AND '1'='2"
    - "' AND 1=0--"
    - "admin'--"
    - "1' OR '1'='1'"
    - "' UNION SELECT NULL--"

  matchers:
    - type: regex
      condition: or
      regex:
        - 'SQL syntax.*MySQL'
        - 'Warning.*mysql_'
        - 'PostgreSQL.*ERROR'
        - 'ORA-[0-9]{5}'
        - 'Microsoft OLE DB Provider'
        - 'Unclosed quotation mark'
        - 'quoted string not properly terminated'
        - 'sqlite3\.OperationalError'
        - 'SQLITE_ERROR'
        - 'SQL logic error'
        - 'syntax error at or near'
        - 'pg_query\(\)'
        - 'mysql_fetch'
        - 'SQLite.*exception'
        - 'SqlException'
        - 'System\.Data\.SqlClient'

  matchers_condition: or
