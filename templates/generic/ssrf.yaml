id: generic-ssrf
info:
  name: Server-Side Request Forgery (SSRF)
  description: Tests for SSRF on API endpoints
  owasp_category: A05:2025
  severity: high
  tags:
    - ssrf
    - injection
    - generic
    - api

requests:
  - name: SSRF metadata
    method: GET
    path: "@api@?url=http://169.254.169.254/latest/meta-data/iam"
    matchers:
      - type: status
        condition: in
        status:
          - 200
          - 404
      - type: word
        part: body
        words:
          - "ami"
          - "iam"
        condition: or
        case_sensitive: false
    matchers_condition: or
    on_match:
      vulnerability: SSRF_METADATA
      message: "SSRF to cloud metadata"
      remediation: "Block private IPs"

  - name: SSRF localhost
    method: GET
    path: "@api@?url=http://localhost/admin"
    matchers:
      - type: status
        condition: in
        status:
          - 200
          - 404
    on_match:
      vulnerability: SSRF_LOCALHOST
      message: "SSRF via localhost"
      remediation: "Block localhost"
