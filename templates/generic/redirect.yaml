id: generic-open-redirect
info:
  name: Open Redirect
  description: Detects open redirect vulnerabilities via URL parameter manipulation
  owasp_category: A03:2025
  severity: medium
  tags:
    - redirect
    - oauth
    - generic

generic:
  endpoint: "{{all_discovered}}"
  method: GET
  parameter: "url"

  payloads:
    - "https://evil.com"
    - "//evil.com"
    - "///evil.com"
    - "https://evil.com%2F%2Fexample.com"
    - "http://example.com@evil.com"

  matchers:
    - type: word
      part: header
      words:
        - "location: https://evil.com"
        - "location: http://evil.com"
        - "location: //evil.com"
      condition: or
      case_sensitive: false
