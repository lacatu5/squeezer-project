id: generic-open-redirect
info:
  name: Open Redirect
  description: Tests for open redirect vulnerabilities
  owasp_category: A03:2021
  severity: medium
  tags:
    - redirect
    - phishing
    - generic

generic:
  endpoint: "{{all_discovered}}"
  method: GET
  parameter: "{{redirect_param}}"

  payloads:
    - "https://evil.com"
    - "//evil.com"
    - "///evil.com"
    - "https://evil.com%2F%2Fexample.com"
    - "http://example.com@evil.com"
    - "\\\\evil.com"
    - "////evil.com"
    - "https://evil.com%00.com"
    - "//evil.com%2F%2F"
    - "javascript:alert(1)//evil.com"

  matchers:
    - type: status
      condition: in
      status:
        - 301
        - 302
        - 303
        - 307
        - 308
    - type: regex
      part: header
      regex:
        - "location:.*evil\.com"
        - "location:.*//evil"
      condition: or
      case_sensitive: false

  matchers_condition: and
