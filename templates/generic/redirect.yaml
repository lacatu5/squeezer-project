id: generic-open-redirect
info:
  name: Open Redirect
  description: Detects open redirect vulnerabilities via URL parameter manipulation
  owasp_category: A03:2025
  severity: medium
  tags:
    - redirect
    - oauth
    - generic

generic:
  endpoint: "{{all_discovered}}"
  method: GET
  parameter: "url"

  payloads:
    - "https://evil.com"
    - "//evil.com"
    - "///evil.com"
    - "https://evil.com%2F%2Fexample.com"
    - "http://example.com@evil.com"

  matchers:
    - type: status
      condition: in
      status:
        - 301
        - 302
        - 303
        - 307
        - 308
    - type: regex
      part: header
      regex:
        - "location:.*evil\.com"
        - "location:.*//evil"
      condition: or
      case_sensitive: false

  matchers_condition: and
