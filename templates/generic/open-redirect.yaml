id: generic-open-redirect
info:
  name: Open URL Redirect
  description: Tests for open redirect on API endpoints
  owasp_category: A05:2025
  severity: medium
  tags:
    - redirect
    - phishing
    - generic
    - dast

requests:
  - name: Open redirect url param
    method: GET
    path: "@api@?url=https://evil.com"
    matchers:
      - type: status
        condition: in
        status:
          - 301
          - 302
          - 303
          - 307
          - 308
      - type: word
        part: header
        words:
          - "evil.com"
        case_sensitive: false
    matchers_condition: and
    on_match:
      vulnerability: OPEN_REDIRECT_URL
      message: "Open redirect via url param"
      remediation: "Whitelist redirect URLs"

  - name: Open redirect next param
    method: GET
    path: "@api@?next=https://evil.com"
    matchers:
      - type: status
        condition: in
        status:
          - 301
          - 302
          - 303
          - 307
          - 308
      - type: word
        part: header
        words:
          - "evil.com"
        case_sensitive: false
    matchers_condition: and
    on_match:
      vulnerability: OPEN_REDIRECT_NEXT
      message: "Open redirect via next param"
      remediation: "Validate redirect URLs"
