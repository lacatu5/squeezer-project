id: generic-debug-endpoints
info:
  name: Debug Endpoints Exposure
  description: Tests for exposed debug endpoints and development tools
  owasp_category: A05:2021
  severity: medium
  tags:
    - debug
    - misconfiguration
    - generic

requests:
  - name: Spring Boot Actuator
    method: GET
    path: /actuator
    matchers:
      - type: status
        status: [200, 403]
    on_match:
      vulnerability: DEBUG_ACTUATOR
      message: Spring Boot Actuator endpoint exposed
      remediation: Disable Actuator in production or restrict access

  - name: Health check endpoint
    method: GET
    path: /health
    matchers:
      - type: json
        selector: "$.status"
      - type: word
        words: ["UP", "DOWN", "status"]
        part: body
    matchers_condition: or
    on_match:
      vulnerability: DEBUG_HEALTH_ENDPOINT
      message: Health check endpoint exposed
      remediation: Restrict access to health endpoints

  - name: Environment variables endpoint
    method: GET
    path: /actuator/env
    matchers:
      - type: status
        status: [200, 403]
    on_match:
      vulnerability: DEBUG_ENV_ENDPOINT
      message: Environment variables endpoint exposed
      remediation: Disable environment endpoint in production

  - name: Application info endpoint
    method: GET
    path: /actuator/info
    matchers:
      - type: status
        status: [200]
    on_match:
      vulnerability: DEBUG_INFO_ENDPOINT
      message: Application info endpoint exposed
      remediation: Disable info endpoint in production

  - name: Admin debug endpoint
    method: GET
    path: /admin/debug
    matchers:
      - type: status
        status: [200, 403]
    on_match:
      vulnerability: DEBUG_ADMIN_ENDPOINT
      message: Debug admin endpoint accessible
      remediation: Remove admin debug endpoints

  - name: Console endpoint
    method: GET
    path: /console
    matchers:
      - type: word
        words:
          - "console"
          - "Erlang"
          - "Node.js"
          - "REPL"
          - "<title>Console"
        part: body
        condition: or
    on_match:
      vulnerability: DEBUG_CONSOLE
      message: Debug console endpoint exposed
      remediation: Remove console access endpoints

  - name: Trace endpoint
    method: GET
    path: /actuator/httptrace
    matchers:
      - type: status
        status: [200, 403]
    on_match:
      vulnerability: DEBUG_TRACE_ENDPOINT
      message: HTTP trace endpoint exposed
      remediation: Disable trace endpoint in production

  - name: Thread dump endpoint
    method: GET
    path: /actuator/threaddump
    matchers:
      - type: status
        status: [200, 403]
    on_match:
      vulnerability: DEBUG_THREADDUMP_ENDPOINT
      message: Thread dump endpoint exposed
      remediation: Disable thread dump endpoint in production

  - name: Heap dump endpoint
    method: GET
    path: /actuator/heapdump
    matchers:
      - type: status
        status: [200, 403]
    on_match:
      vulnerability: DEBUG_HEAPDUMP_ENDPOINT
      message: Heap dump endpoint exposed
      remediation: Disable heap dump endpoint in production
