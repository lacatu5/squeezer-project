id: generic-idor
info:
  name: Insecure Direct Object Reference (IDOR)
  description: Tests for IDOR by enumerating IDs on API endpoints
  owasp_category: A01:2021
  severity: high
  tags:
    - idor
    - access-control
    - generic
    - api

requests:
  - name: IDOR check - try ID 1
    method: GET
    path: @api@
    matchers:
      - type: status
        condition: in
        status:
          - 200
          - 403
      - type: word
        part: body
        words:
          - "id"
          - "email"
          - "name"
          - "data"
          - "user"
        condition: or
        case_sensitive: false
    matchers_condition: and
    on_match:
      vulnerability: IDOR_ACCESSIBLE
      message: API endpoint accessible - verify access controls
      remediation: Implement authentication and authorization checks

  - name: IDOR sequential ID
    method: GET
    path: @api@/1
    matchers:
      - type: status
        condition: in
        status:
          - 200
      - type: word
        part: body
        words:
          - "id"
          - "data"
        condition: or
        case_sensitive: false
    matchers_condition: and
    on_match:
      vulnerability: IDOR_SEQUENTIAL_ID
      message: Sequential ID access possible - verify ownership
      remediation: Use non-sequential IDs and verify resource ownership

  - name: IDOR negative ID
    method: GET
    path: @api@/-1
    matchers:
      - type: status
        condition: in
        status:
          - 200
          - 500
    on_match:
      vulnerability: IDOR_NEGATIVE_ID
      message: API accepts negative ID - validate input range
      remediation: Validate ID format and range on server side
