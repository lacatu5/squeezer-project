id: generic-idor
info:
  name: Insecure Direct Object Reference (IDOR)
  description: Tests for IDOR vulnerabilities on API endpoints via sequential ID enumeration
  owasp_category: A01:2025
  severity: high
  tags:
    - idor
    - access-control
    - generic
    - api

requests:
  - name: IDOR enumerate ID 1 (API)
    method: GET
    path: "@api@/1"
    matchers_condition: and
    matchers:
      - type: status
        condition: in
        status:
          - 200
          - 403
      - type: word
        part: body
        words:
          - '"email"'
          - '"password"'
          - '"role"'
          - '"username"'
          - '"address"'
          - '"phone"'
        condition: or
        case_sensitive: false
      - type: word
        part: body
        words:
          - '"price"'
          - '"description"'
        condition: or
        case_sensitive: false
        negative: true
    on_match:
      vulnerability: IDOR_ACCESSIBLE
      message: Sequential ID 1 returns sensitive user data - IDOR vulnerability possible
      remediation: Implement authentication and ownership verification; use non-sequential IDs

  - name: IDOR enumerate ID 2 (API)
    method: GET
    path: "@api@/2"
    matchers_condition: and
    matchers:
      - type: status
        condition: in
        status:
          - 200
      - type: word
        part: body
        words:
          - '"email"'
          - '"password"'
          - '"role"'
          - '"username"'
          - '"address"'
          - '"phone"'
        condition: or
        case_sensitive: false
      - type: word
        part: body
        words:
          - '"price"'
          - '"description"'
        condition: or
        case_sensitive: false
        negative: true
    on_match:
      vulnerability: IDOR_SEQUENTIAL
      message: Sequential ID 2 also returns sensitive data - enumeration confirmed
      remediation: Use UUIDs or random identifiers; verify resource ownership

  - name: IDOR enumerate ID 0
    method: GET
    path: "@api@/0"
    matchers_condition: and
    matchers:
      - type: status
        condition: in
        status:
          - 200
          - 403
      - type: word
        part: body
        words:
          - '"email"'
          - '"password"'
          - '"role"'
          - '"username"'
        condition: or
        case_sensitive: false
      - type: word
        part: body
        words:
          - '"price"'
        condition: or
        case_sensitive: false
        negative: true
    on_match:
      vulnerability: IDOR_ZERO_ID
      message: ID 0 returns sensitive data - zero-based ID enumeration works
      remediation: Validate ID ranges; use UUIDs

  - name: IDOR cart/basket test
    method: GET
    path: "@api@/cart@/1"
    matchers:
      - type: status
        values: [200]
    on_match:
      vulnerability: IDOR_CART
      message: Cart/basket endpoint accessible with ID 1 without authentication
      remediation: Verify cart ownership on every request

  - name: IDOR items endpoint
    method: GET
    path: "@api@/items@"
    matchers:
      - type: status
        values: [200]
    on_match:
      vulnerability: UNAUTHORIZED_ACCESS
      message: Items endpoint accessible without authentication
      remediation: Require authentication to access item data
