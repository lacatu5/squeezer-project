id: generic-jwt-weakness
info:
  name: JWT Token Weaknesses
  description: Tests for weak JWT implementations (requires valid JWT from {{jwt_token}})
  owasp_category: A08:2021
  severity: high
  tags:
    - jwt
    - token
    - integrity
    - generic

note: |
  This template requires a valid JWT token from the target application.
  The scanner should extract JWTs from login responses and test variations.

requests:
  - name: JWT algorithm confusion test
    method: GET
    path: /
    headers:
      Authorization: "Bearer {{jwt_token}}"
    matchers:
      - type: regex
        part: header
        regex:
          - 'application/jwt'
        negative: true
      - type: status
        values: [200, 201, 401, 403]
    on_match:
      vulnerability: JWT_ACCEPTED
      message: JWT authentication detected - further manual testing recommended
      remediation: Verify JWT signatures, validate algorithm, check expiration

  - name: JWT missing header
    method: GET
    path: /
    matchers:
      - type: word
        part: header
        words:
          - "authorization"
        negative: true
      - type: status
        values: [200, 201]
    on_match:
      vulnerability: AUTH_OPTIONAL
      message: Endpoint accessible without JWT - authentication not enforced
      remediation: Enforce authentication on protected endpoints
