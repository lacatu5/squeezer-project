id: generic-rate-limit
info:
  name: Missing Rate Limiting
  description: Tests for absence of rate limiting on endpoints
  owasp_category: A04:2021
  severity: medium
  tags:
    - rate-limit
    - dos
    - abuse
    - generic

requests:
  - name: Check rate limit headers
    method: GET
    path: /
    matchers:
      - type: word
        part: header
        words:
          - "x-rate-limit"
          - "x-ratelimit"
          - "ratelimit-"
        condition: or
        case_sensitive: false
        negative: true
    on_match:
      vulnerability: MISSING_RATE_LIMIT_HEADERS
      message: No rate limit headers present - potential DoS vulnerability
      remediation: Implement rate limiting and expose rate limit headers

  - name: Test endpoint rate limiting
    method: GET
    path: /
    repeat: 20
    matchers:
      - type: status
        condition: not_in
        status:
          - 429
          - 503
    on_match:
      vulnerability: NO_RATE_LIMITING
      message: No rate limiting detected - endpoint accepts excessive requests
      remediation: Implement rate limiting to prevent abuse and DoS
