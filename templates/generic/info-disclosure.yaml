id: generic-info-disclosure
info:
  name: Information Disclosure
  description: Detects version disclosure and debugging info
  owasp_category: A05:2025
  severity: low
  tags:
    - info-disclosure
    - generic

requests:
  - name: Server version in headers
    method: GET
    path: "/"
    matchers:
      - type: regex
        part: header
        regex:
          - "(?i)server: (apache|nginx|iis|tomcat)/[0-9.]+"
      - type: status
        status:
          - 200
    matchers_condition: and
    on_match:
      vulnerability: SERVER_VERSION_EXPOSED
      message: "Server version exposed"
      remediation: "Hide server version"

  - name: PHP version exposed
    method: GET
    path: "/"
    matchers:
      - type: regex
        part: header
        regex:
          - "(?i)x-powered-by:.*php/[0-9.]+"
      - type: status
        status:
          - 200
    matchers_condition: and
    on_match:
      vulnerability: PHP_VERSION_EXPOSED
      message: "PHP version exposed"
      remediation: "Disable expose_php"

  - name: Stack trace exposure
    method: GET
    path: "/404notfound-test"
    matchers:
      - type: word
        part: body
        words:
          - "Traceback"
          - "Stack trace"
          - "at line"
        condition: or
      - type: status
        status:
          - 500
    matchers_condition: and
    on_match:
      vulnerability: STACK_TRACE_EXPOSED
      message: "Stack traces exposed"
      remediation: "Use custom error pages"
