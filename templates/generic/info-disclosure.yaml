id: generic-info-disclosure
info:
  name: Information Disclosure - 404/500 Errors
  severity: low
  description: Tests for verbose error messages that leak sensitive information
  tags:
    - information-disclosure
    - error-handling
    - generic

variables:
  random_path: "{{rand_base(8)}}"

requests:
  - name: Test non-existent endpoint for verbose errors
    method: GET
    path: /{{random_path}}
    headers: {}
    matchers:
      - type: status
        values: [404, 500, 501, 502, 503]
      - type: word
        words: ["stack trace", "exception", "error at", "line", "file:", "directory", "sql", "query", "mysql", "postgres", "mongodb", "npm", "python", "java", "internal"]
        condition: or
        part: body
    on_match:
      vulnerability: INFORMATION_DISCLOSURE
      message: Verbose error messages may leak sensitive information (stack traces, paths, technology details)
      remediation: Use generic error messages in production; log detailed errors server-side only
      evidence_strength: heuristic
