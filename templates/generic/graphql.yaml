id: generic-graphql-introspection
info:
  name: GraphQL Introspection
  description: Detects exposed GraphQL schema via introspection query
  owasp_category: A02:2025
  severity: medium
  tags:
    - graphql
    - information-disclosure
    - generic

requests:
  - name: GraphQL Introspection
    method: POST
    path: /graphql
    headers:
      Content-Type: application/json
    json_body:
      query: "{__schema{queryType{name}}}"
    matchers:
      - type: word
        words:
          - "queryType"
          - "mutationType"
          - "subscriptionType"
        part: body
        condition: or
    on_match:
      vulnerability: GRAPHQL_INTROSPECTION
      message: GraphQL introspection enabled - schema information exposed
      remediation: Disable introspection in production environments
