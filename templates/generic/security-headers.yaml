id: generic-security-headers
info:
  name: Missing Security Headers
  description: Detects missing HTTP security headers
  owasp_category: A05:2025
  severity: info
  tags:
    - misconfig
    - headers
    - generic

requests:
  - name: Missing X-Frame-Options
    method: GET
    path: "/"
    matchers:
      - type: regex
        part: header
        regex:
          - "(?i)x-frame-options"
        negative: true
      - type: status
        condition: nin
        status:
          - 301
          - 302
    matchers_condition: and
    on_match:
      vulnerability: MISSING_X_FRAME_OPTIONS
      message: "Missing X-Frame-Options - clickjacking risk"
      remediation: "Add X-Frame-Options: DENY"

  - name: Missing X-Content-Type-Options
    method: GET
    path: "/"
    matchers:
      - type: regex
        part: header
        regex:
          - "(?i)x-content-type-options"
        negative: true
      - type: status
        condition: nin
        status:
          - 301
          - 302
    matchers_condition: and
    on_match:
      vulnerability: MISSING_X_CONTENT_TYPE
      message: "Missing X-Content-Type-Options"
      remediation: "Add X-Content-Type-Options: nosniff"

  - name: Missing CSP
    method: GET
    path: "/"
    matchers:
      - type: regex
        part: header
        regex:
          - "(?i)content-security-policy"
        negative: true
      - type: status
        condition: nin
        status:
          - 301
          - 302
    matchers_condition: and
    on_match:
      vulnerability: MISSING_CSP
      message: "Missing Content-Security-Policy"
      remediation: "Implement CSP header"
