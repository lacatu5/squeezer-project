id: generic-security-headers
info:
  name: Missing Security Headers
  description: Tests for missing security headers
  owasp_category: A05:2021
  severity: low
  tags:
    - headers
    - misconfiguration
    - generic

requests:
  - name: Check Content-Security-Policy
    method: GET
    path: /
    matchers:
      - type: word
        part: header
        words:
          - "content-security-policy"
        condition: and
        case_sensitive: false
        negative: true
    on_match:
      vulnerability: MISSING_CSP
      message: Missing Content-Security-Policy header - XSS risk
      remediation: Implement strict CSP policy

  - name: Check HSTS
    method: GET
    path: /
    matchers:
      - type: word
        part: header
        words:
          - "strict-transport-security"
        condition: and
        case_sensitive: false
        negative: true
    on_match:
      vulnerability: MISSING_HSTS
      message: Missing HSTS header - TLS downgrade risk
      remediation: Enable HSTS with max-age of at least 1 year

  - name: Check X-Frame-Options
    method: GET
    path: /
    matchers:
      - type: word
        part: header
        words:
          - "x-frame-options"
        condition: and
        case_sensitive: false
        negative: true
    on_match:
      vulnerability: MISSING_X_FRAME_OPTIONS
      message: Missing X-Frame-Options header - clickjacking risk
      remediation: Add X-Frame-Options: DENY or SAMEORIGIN

  - name: Check X-Content-Type-Options
    method: GET
    path: /
    matchers:
      - type: word
        part: header
        words:
          - "x-content-type-options"
        condition: and
        case_sensitive: false
        negative: true
    on_match:
      vulnerability: MISSING_X_CONTENT_TYPE_OPTIONS
      message: Missing X-Content-Type-Options header - MIME sniffing risk
      remediation: Add X-Content-Type-Options: nosniff

  - name: Check X-XSS-Protection
    method: GET
    path: /
    matchers:
      - type: word
        part: header
        words:
          - "x-xss-protection"
        condition: and
        case_sensitive: false
        negative: true
    on_match:
      vulnerability: MISSING_X_XSS_PROTECTION
      message: Missing X-XSS-Protection header
      remediation: Add X-XSS-Protection: 1; mode=block

  - name: Check Referrer-Policy
    method: GET
    path: /
    matchers:
      - type: word
        part: header
        words:
          - "referrer-policy"
        condition: and
        case_sensitive: false
        negative: true
    on_match:
      vulnerability: MISSING_REFERRER_POLICY
      message: Missing Referrer-Policy header - privacy risk
      remediation: Add Referrer-Policy: no-referrer
