id: generic-xss-reflected
info:
  name: Reflected Cross-Site Scripting
  description: Tests for reflected XSS on all discovered API endpoints
  owasp_category: A05:2025
  severity: medium
  tags:
    - xss
    - rxss
    - generic
    - dast

requests:
  - name: XSS script tag
    method: GET
    path: "@api@?q=<script>alert(1)</script>"
    matchers:
      - type: word
        part: body
        words:
          - "<script>alert(1)</script>"
        case_sensitive: false
    on_match:
      vulnerability: REFLECTED_XSS_SCRIPT
      message: "Reflected XSS via script tag"
      remediation: "Encode user input"

  - name: XSS img onerror
    method: GET
    path: "@api@?search=<img src=x onerror=alert(1)>"
    matchers:
      - type: word
        part: body
        words:
          - "<img src=x onerror=alert(1)>"
        case_sensitive: false
    on_match:
      vulnerability: REFLECTED_XSS_IMG
      message: "Reflected XSS via img tag"
      remediation: "Encode user input"

  - name: XSS attribute breaker
    method: GET
    path: "@api@?id=\"><script>alert(1)</script>"
    matchers:
      - type: word
        part: body
        words:
          - "\"><script>alert(1)</script>"
        case_sensitive: false
    on_match:
      vulnerability: REFLECTED_XSS_ATTR
      message: "Reflected XSS in attribute"
      remediation: "HTML encode output"
