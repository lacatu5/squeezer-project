id: excessive-quantity
info:
  name: Excessive Quantity Business Logic Flaw
  description: Detects if server accepts unrealistically large quantity values
  tags:
    - business-logic
    - input-validation

requests:
  - name: Add item with excessive quantity
    method: POST
    path: /api/BasketItems/{{basket_id}}
    headers:
      Content-Type: application/json
    body: '{"ProductId": 1, "quantity": 999999, "basketId": "{{basket_id}}"}'
    matchers:
      - type: semantic
        selector: "$.data.quantity"
        condition: gte
        value: 10000
    on_match:
      vulnerability: EXCESSIVE_QUANTITY
      message: Server accepted excessive quantity value
      remediation: Validate reasonable upper bounds for quantity values
