# Benchmark: Katana + Nuclei vs. OWASP Juice Shop

This document records the procedure and results of executing a benchmark using industry-standard tools (Katana and Nuclei) against OWASP Juice Shop. The objective is to establish a baseline to compare with the efficacy of the Squeezer framework, specifically regarding "Scanner Blindness" and business logic vulnerabilities.

## Test Environment
*   **Target**: OWASP Juice Shop
*   **URL**: `http://localhost:3000`
*   **Tools**:
    *   `katana` (v1.4.0)
    *   `nuclei` (v3.6.2)

## Methodology

The test simulates a "State of the Art" flow using modern ProjectDiscovery tools, dividing the process into discovery and scanning.

### Step 1: Discovery (Crawling)
**Katana** was used to map the attack surface, enabling the JavaScript engine and XHR endpoint extraction to simulate SPA behavior.

```bash
katana -u http://localhost:3000 -jc -xhr -o katana.txt
```

*   `-jc` (JavaScript Crawling): Enables headless browser crawling to execute JS and discover dynamic links.
*   `-xhr` (XHR Extraction): Extracts endpoints from XMLHttpRequest requests.
*   `-o katana.txt`: Saves results to a text file.

### Step 2: Scanning (Fuzzing/Scanning)
**Nuclei** was used, fed by the endpoint list generated by Katana. For a fair comparison, templates were filtered to search for vulnerability classes similar to those implemented by Squeezer (IDOR, JWT, sensitive exposures).

```bash
# Template update (optional/prerequisite)
nuclei -update-templates -update-template-dir nuclei-templates

# Scan execution
nuclei -l katana.txt -t nuclei-templates -tags idor,jwt,exposure,config -o nuclei.json -jsonl
```

*   `-l katana.txt`: Target list (discovered URLs).
*   `-t nuclei-templates`: Template directory.
*   `-tags ...`: Filters templates by relevant tags.
*   `-o nuclei.json -jsonl`: Output in JSONL format for analysis.

## Results

### Quantitative Metrics
*   **Discovered Endpoints**: 88 unique URLs (including static assets and API routes like `/api/Users`, `/rest/user/login`).
*   **Findings (Vulnerabilities)**: 1 relevant finding.
    *   `swagger-api`: Information Disclosure (`/api-docs/swagger.yaml`).
*   **Execution Time**: ~2 minutes (with interruptions).

### Qualitative Analysis

1.  **Business Logic Blindness**: Nuclei failed to detect critical known logic vulnerabilities in Juice Shop, such as:
    *   JWT Manipulation ('none' algorithm).
    *   Negative quantities in basket (Business Logic Flaw).
    *   Active IDORs (sequential resource enumeration).

2.  **Lack of Context (State)**: The absence of findings is attributed to the "stateless" nature of Nuclei's generic templates. No authenticated session was maintained, nor were specific sequences of steps executed to reach deep vulnerable states.

3.  **Performance Issues**: During the scan, the target server (Juice Shop) became unstable, resulting in multiple connection errors (`Skipped localhost:3000 from target list as found unresponsive 30 times`). This demonstrates that generic scanning defaults can be **overkill** for resource-constrained or fragile environments, effectively causing a local Denial of Service (DoS). Such aggressive concurrency often renders the application unusable for subsequent checks, a critical limitation when testing non-production development environments.

## Conclusion

The "State of the Art" combination (Katana + Nuclei), while powerful for infrastructure vulnerabilities (known CVEs) and static misconfigurations (exposed Swagger), proved ineffective for identifying business logic flaws in a complex SPA like Juice Shop. This validates the need for a "Squeezer" approach: endpoint discovery combined with templates that handle state (authentication) and specific business logic.
