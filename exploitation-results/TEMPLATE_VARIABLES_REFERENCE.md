# DAST Template Variables Reference

## Generic Template Variables

### Endpoint Variables
| Variable | Usage | Templates |
|----------|--------|-----------|
| `{{all_discovered}}` | All discovered API endpoints | sqli-get, xss-reflected, nosqli, command-injection, path-traversal, ssrf, open-redirect, ssti |
| `{{login_endpoint}}` | Login/auth endpoints | auth-bypass |

### Parameter Variables
| Variable | Usage | Templates |
|----------|--------|-----------|
| `{{input_param}}` | Generic input parameter name | sqli-get, xss-reflected, nosqli, command-injection, ssti |
| `{{file_param}}` | File path parameter | path-traversal |
| `{{url_param}}` | URL parameter for SSRF/redirects | ssrf |
| `{{redirect_param}}` | Redirect parameter name | open-redirect |
| `{{credentials_param}}` | Credentials parameter | auth-bypass |

## App-Specific Template Variables (Juice Shop)

| Variable | Usage | Templates |
|----------|--------|-----------|
| `{{bearer_token}}` | JWT auth token | user-idor, feedback-idor, price-manipulation, negative-quantity |
| `{{basket_id}}` | Shopping basket ID | price-manipulation, negative-quantity |
| `{{rand_int()}}` | Random integer generator | mass-assignment |

## Variable Replacement Logic

When running scans, the scanner should:
1. **Discover endpoints** via crawling/guessing
2. **Identify parameter names** from request analysis
3. **Generate auth tokens** via login flow
4. **Replace variables** with actual values before testing

### Example Variable Substitution

```yaml
# Template
endpoint: "{{all_discovered}}"
method: GET
parameter: "{{input_param}}"

# After substitution for Juice Shop:
endpoint: "http://localhost:3000/rest/products/search"
method: GET
parameter: "q"
```

## Template Categories

### Injection Templates (use `{{input_param}}`)
- `generic-sqli-get.yaml`
- `generic-xss-reflected.yaml`
- `generic-nosqli.yaml`
- `generic-command-injection.yaml`
- `generic-ssti.yaml`

### File Access Templates (use `{{file_param}}`)
- `generic-path-traversal.yaml`

### Request Forgery Templates (use `{{url_param}}` or `{{redirect_param}}`)
- `generic-ssrf.yaml`
- `generic-open-redirect.yaml`

### Authentication Templates (use `{{login_endpoint}}`, `{{credentials_param}}`)
- `generic-auth-bypass.yaml`

### Configuration Templates (no variables needed)
- `generic-cors-misconfiguration.yaml`
- `generic-rate-limit.yaml`
- `generic-security-headers.yaml`
- `generic-info-disclosure.yaml`
- `generic-jwt-weakness.yaml`
- `generic-debug-endpoints.yaml`
- `generic-graphql-introspection.yaml`

### App-Specific Business Logic Templates (use auth + app vars)
- `user-idor.yaml` - `{{bearer_token}}`
- `feedback-idor.yaml` - `{{bearer_token}}`
- `price-manipulation.yaml` - `{{bearer_token}}`, `{{basket_id}}`
- `negative-quantity.yaml` - `{{bearer_token}}`, `{{basket_id}}`
- `mass-assignment.yaml` - `{{rand_int()}}`
