name: OWASP Juice Shop
base_url: http://localhost:3000

authentication:
  type: form
  username: "jim@juice-sh.op"
  password: "ncc-1701"
  login:
    url: /rest/user/login
    method: POST
    payload:
      email: "{{AUTH_USERNAME}}"
      password: "{{AUTH_PASSWORD}}"
    headers:
      Content-Type: application/json
    extract:
      - name: token
        selector: "$.authentication.token"
        location: body
    apply:
      headers:
        Authorization: "Bearer {{token}}"

variables:
  # JWT testing variables
  role_claim: "role"

endpoints:
  base: /api
  custom:
    # Generic vulnerability endpoint mappings
    sqli: /rest/products/search?q=
    sqli_post: /rest/user/login
    command_injection: /rest/feedback/
    xss_reflected: /rest/products/search?q=
    xss_stored: /rest/feedback/
    path_traversal: /rest/products/search?q=
    ssrf: /rest/products/search?q=

    # JWT testing endpoints (for generic JWT templates)
    login_endpoint: /rest/user/login
    jwt_token_selector: "$.authentication.token"
    admin_endpoint: /rest/admin/application-configuration
    protected_endpoint: /rest/admin/application-configuration

    # Juice Shop specific endpoints
    basket: /api/Basket
    basket_items: /api/BasketItems

timeout: 30.0
parallel: 5
